<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Zona Horaria - M√©xico Centro</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-card {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0c7bb3;
        }
        h2 {
            color: #333;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        .result {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 5px 0;
        }
        .success {
            color: #047857;
            font-weight: bold;
        }
        .error {
            color: #dc2626;
            font-weight: bold;
        }
        button {
            background: #0c7bb3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            margin: 5px;
        }
        button:hover {
            background: #0a679b;
        }
    </style>
</head>
<body>
    <h1>üïê Test de Zona Horaria - M√©xico Centro</h1>

    <div class="test-card">
        <h2>1. Verificaci√≥n de Carga de Utilidades</h2>
        <div id="test-load" class="result">Verificando...</div>
    </div>

    <div class="test-card">
        <h2>2. Hora Actual en M√©xico</h2>
        <div id="test-current" class="result">Calculando...</div>
    </div>

    <div class="test-card">
        <h2>3. Formato de Fechas</h2>
        <div id="test-format-date" class="result">Formateando...</div>
    </div>

    <div class="test-card">
        <h2>4. Formato de Horas</h2>
        <div id="test-format-time" class="result">Formateando...</div>
    </div>

    <div class="test-card">
        <h2>5. Fechas Relativas</h2>
        <div id="test-relative" class="result">Calculando...</div>
    </div>

    <div class="test-card">
        <h2>6. Comparaci√≥n con UTC</h2>
        <div id="test-utc" class="result">Comparando...</div>
    </div>

    <div class="test-card">
        <h2>7. Validaciones de Fecha</h2>
        <div id="test-validations" class="result">Validando...</div>
    </div>

    <div class="test-card">
        <h2>Tests Interactivos</h2>
        <button onclick="testFormato()">Probar Formato Personalizado</button>
        <button onclick="testRangos()">Probar Rangos de Fechas</button>
        <button onclick="location.reload()">Reiniciar Tests</button>
    </div>

    <script src="js/timezone-utils.js"></script>
    <script>
        const TZ = window.TimezoneMexico;

        function mostrarResultado(id, texto, esExito = true) {
            const elemento = document.getElementById(id);
            elemento.innerHTML = texto;
            elemento.className = 'result ' + (esExito ? 'success' : 'error');
        }

        // Test 1: Verificar carga
        function test1() {
            if (typeof TZ !== 'undefined') {
                mostrarResultado('test-load', '‚úÖ Utilidades de zona horaria cargadas correctamente', true);
            } else {
                mostrarResultado('test-load', '‚ùå Error: No se pudieron cargar las utilidades', false);
            }
        }

        // Test 2: Hora actual
        function test2() {
            try {
                const ahora = TZ.obtenerFechaHoraMexico();
                const texto = `
                    ‚úÖ Fecha/Hora M√©xico: ${ahora.toLocaleString('es-MX', { timeZone: 'America/Mexico_City' })}<br>
                    üìÖ Zona horaria: ${TZ.TIMEZONE}<br>
                    üïê Timestamp: ${ahora.toISOString()}
                `;
                mostrarResultado('test-current', texto, true);
            } catch (e) {
                mostrarResultado('test-current', '‚ùå Error: ' + e.message, false);
            }
        }

        // Test 3: Formato de fechas
        function test3() {
            try {
                const hoy = new Date();
                const manana = new Date();
                manana.setDate(manana.getDate() + 1);
                
                const texto = `
                    ‚úÖ Formato legible: ${TZ.formatearFechaLegible(hoy)}<br>
                    ‚úÖ Formato input: ${TZ.formatearFechaInput(hoy)}<br>
                    ‚úÖ Formato ISO: ${TZ.formatearISOMexico(hoy)}<br>
                    ‚úÖ Ma√±ana: ${TZ.formatearFechaLegible(manana)}
                `;
                mostrarResultado('test-format-date', texto, true);
            } catch (e) {
                mostrarResultado('test-format-date', '‚ùå Error: ' + e.message, false);
            }
        }

        // Test 4: Formato de horas
        function test4() {
            try {
                const texto = `
                    ‚úÖ Hora actual: ${TZ.formatearHoraLegible(new Date())}<br>
                    ‚úÖ 14:30 ‚Üí ${TZ.formatearHoraLegible('14:30')}<br>
                    ‚úÖ 09:15 ‚Üí ${TZ.formatearHoraLegible('09:15')}<br>
                    ‚úÖ 23:45 ‚Üí ${TZ.formatearHoraLegible('23:45')}<br>
                    ‚úÖ Input hora: ${TZ.formatearHoraInput(new Date())}
                `;
                mostrarResultado('test-format-time', texto, true);
            } catch (e) {
                mostrarResultado('test-format-time', '‚ùå Error: ' + e.message, false);
            }
        }

        // Test 5: Fechas relativas
        function test5() {
            try {
                const hoy = new Date();
                const ayer = new Date();
                ayer.setDate(ayer.getDate() - 1);
                const manana = new Date();
                manana.setDate(manana.getDate() + 1);
                const en5dias = new Date();
                en5dias.setDate(en5dias.getDate() + 5);
                
                const texto = `
                    ‚úÖ Ayer: ${TZ.textoFechaRelativa(TZ.formatearFechaInput(ayer))}<br>
                    ‚úÖ Hoy: ${TZ.textoFechaRelativa(TZ.formatearFechaInput(hoy))}<br>
                    ‚úÖ Ma√±ana: ${TZ.textoFechaRelativa(TZ.formatearFechaInput(manana))}<br>
                    ‚úÖ En 5 d√≠as: ${TZ.textoFechaRelativa(TZ.formatearFechaInput(en5dias))}<br>
                    ‚úÖ D√≠as desde hoy: ${TZ.diasDesdeHoy(TZ.formatearFechaInput(hoy))}
                `;
                mostrarResultado('test-relative', texto, true);
            } catch (e) {
                mostrarResultado('test-relative', '‚ùå Error: ' + e.message, false);
            }
        }

        // Test 6: Comparaci√≥n UTC
        function test6() {
            try {
                const utcNow = new Date();
                const mexicoNow = TZ.obtenerFechaHoraMexico();
                
                const texto = `
                    üåç Hora UTC: ${utcNow.toISOString()}<br>
                    üá≤üáΩ Hora M√©xico: ${mexicoNow.toLocaleString('es-MX', { timeZone: 'America/Mexico_City' })}<br>
                    ‚è∞ Diferencia: ${(mexicoNow.getTimezoneOffset() / 60) * -1} horas
                `;
                mostrarResultado('test-utc', texto, true);
            } catch (e) {
                mostrarResultado('test-utc', '‚ùå Error: ' + e.message, false);
            }
        }

        // Test 7: Validaciones
        function test7() {
            try {
                const hoy = TZ.formatearFechaInput();
                const ayer = TZ.formatearFechaInput(new Date(Date.now() - 86400000));
                const manana = TZ.formatearFechaInput(new Date(Date.now() + 86400000));
                
                const texto = `
                    ‚úÖ ¬øEs hoy hoy?: ${TZ.esFechaHoy(hoy) ? 'S√≠' : 'No'}<br>
                    ‚úÖ ¬øEs ayer pasado?: ${TZ.esFechaPasada(ayer) ? 'S√≠' : 'No'}<br>
                    ‚úÖ ¬øEs ma√±ana pasado?: ${TZ.esFechaPasada(manana) ? 'S√≠' : 'No'}<br>
                    ‚úÖ Fecha m√≠nima input: ${TZ.fechaMinimaInput()}<br>
                    ‚úÖ Rango mes actual: ${TZ.rangoMesActual().inicio} a ${TZ.rangoMesActual().fin}
                `;
                mostrarResultado('test-validations', texto, true);
            } catch (e) {
                mostrarResultado('test-validations', '‚ùå Error: ' + e.message, false);
            }
        }

        // Test interactivo
        function testFormato() {
            const fecha = prompt('Ingresa una fecha (YYYY-MM-DD):', '2025-12-25');
            if (fecha) {
                alert(`Formato legible: ${TZ.formatearFechaLegible(fecha)}\nD√≠as desde hoy: ${TZ.diasDesdeHoy(fecha)}\nTexto relativo: ${TZ.textoFechaRelativa(fecha)}`);
            }
        }

        function testRangos() {
            const rango = TZ.rangoMesActual();
            alert(`Mes actual:\nInicio: ${rango.inicio}\nFin: ${rango.fin}`);
        }

        // Ejecutar todos los tests
        setTimeout(() => {
            test1();
            test2();
            test3();
            test4();
            test5();
            test6();
            test7();
        }, 100);
    </script>
</body>
</html>
